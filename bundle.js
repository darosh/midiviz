var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(e,t,n){e.$$.on_destroy.push(function(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}(t,n))}const l="undefined"!=typeof window;let c=l?()=>window.performance.now():()=>Date.now(),h=l?e=>requestAnimationFrame(e):e;const f=new Set;let p,d=!1;function m(){f.forEach(e=>{e[0](c())||(f.delete(e),e[1]())}),(d=f.size>0)&&h(m)}function _(e){let t;return d||(d=!0,h(m)),{promise:new Promise(n=>{f.add(t=[e,n])}),abort(){f.delete(t)}}}function g(e,t){e.appendChild(t)}function y(e,t,n){e.insertBefore(t,n||null)}function E(e){e.parentNode.removeChild(e)}function v(e){return document.createElement(e)}function M(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function b(e){return document.createTextNode(e)}function S(){return b(" ")}function w(){return b("")}function I(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function x(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e){p=e}const N=[],T=[],D=[],C=[],$=Promise.resolve();let R=!1;function P(e){D.push(e)}function G(){const e=new Set;do{for(;N.length;){const e=N.shift();A(e),H(e.$$)}for(;T.length;)T.pop()();for(let t=0;t<D.length;t+=1){const n=D[t];e.has(n)||(n(),e.add(n))}D.length=0}while(N.length);for(;C.length;)C.pop()();R=!1}function H(e){null!==e.fragment&&(e.update(e.dirty),o(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(P))}const O=new Set;let L;function z(){L={r:0,c:[],p:L}}function k(){L.r||o(L.c),L=L.p}function B(e,t){e&&e.i&&(O.delete(e),e.i(t))}function Y(e,t,n,r){if(e&&e.o){if(O.has(e))return;O.add(e),L.c.push(()=>{O.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const j="undefined"!=typeof window?window:global;function F(e,t){e.d(1),t.delete(e.key)}function q(e,t){Y(e,1,1,()=>{t.delete(e.key)})}function W(e,t,n,r,i,o,s,a,u,l,c,h){let f=e.length,p=o.length,d=f;const m={};for(;d--;)m[e[d].key]=d;const _=[],g=new Map,y=new Map;for(d=p;d--;){const e=h(i,o,d),a=n(e);let u=s.get(a);u?r&&u.p(t,e):(u=l(a,e)).c(),g.set(a,_[d]=u),a in m&&y.set(a,Math.abs(d-m[a]))}const E=new Set,v=new Set;function M(e){B(e,1),e.m(a,c),s.set(e.key,e),c=e.first,p--}for(;f&&p;){const t=_[p-1],n=e[f-1],r=t.key,i=n.key;t===n?(c=t.first,f--,p--):g.has(i)?!s.has(r)||E.has(r)?M(t):v.has(i)?f--:y.get(r)>y.get(i)?(v.add(r),M(t)):(E.add(i),f--):(u(n,s),f--)}for(;f--;){const t=e[f];g.has(t.key)||u(t,s)}for(;p;)M(_[p-1]);return _}function U(e,t){const n={},r={},i={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const e in s)e in a||(r[e]=1);for(const e in a)i[e]||(n[e]=a[e],i[e]=1);e[o]=a}else for(const e in s)i[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function V(e){return"object"==typeof e&&null!==e?e:{}}function X(e){e&&e.c()}function Q(e,t,n){const{fragment:i,on_mount:a,on_destroy:u,after_update:l}=e.$$;i&&i.m(t,n),P(()=>{const t=a.map(r).filter(s);u?u.push(...t):o(t),e.$$.on_mount=[]}),l.forEach(P)}function Z(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx={})}function K(e,t){e.$$.dirty||(N.push(e),R||(R=!0,$.then(G)),e.$$.dirty=i()),e.$$.dirty[t]=!0}function J(t,n,r,s,a,u){const l=p;A(t);const c=n.props||{},h=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:i(),dirty:null};let f=!1;h.ctx=r?r(t,c,(e,n,r=n)=>(h.ctx&&a(h.ctx[e],h.ctx[e]=r)&&(h.bound[e]&&h.bound[e](r),f&&K(t,e)),n)):c,h.update(),f=!0,o(h.before_update),h.fragment=!!s&&s(h.ctx),n.target&&(n.hydrate?h.fragment&&h.fragment.l(function(e){return Array.from(e.childNodes)}(n.target)):h.fragment&&h.fragment.c(),n.intro&&B(t.$$.fragment),Q(t,n.target,n.anchor),G()),A(l)}class ee{$destroy(){Z(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}var te="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var ne=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){!function(t){function n(){if(n.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(n.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(e){return this._nrpnEventsEnabled=e,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var r=new n;function i(e){var t=this;this._userHandlers={channel:{},system:{}},this._midiInput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiInput.connection}},id:{enumerable:!0,get:function(){return t._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiInput.name}},state:{enumerable:!0,get:function(){return t._midiInput.state}},type:{enumerable:!0,get:function(){return t._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function o(e){var t=this;this._midiOutput=e,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return t._midiOutput.connection}},id:{enumerable:!0,get:function(){return t._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return t._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return t._midiOutput.name}},state:{enumerable:!0,get:function(){return t._midiOutput.state}},type:{enumerable:!0,get:function(){return t._midiOutput.type}}})}n.prototype.enable=function(e,t){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:t}).then(function(t){var n,r=[],i=[];this.interface=t,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(e){r.push(e)};for(var o=t.inputs.values(),s=o.next();s&&!s.done;s=o.next())i.push(s.value.open());for(var a=t.outputs.values(),u=a.next();u&&!u.done;u=a.next())i.push(u.value.open());function l(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof e&&e.call(this),r.forEach(function(e){this._onInterfaceStateChange(e)}.bind(this))}n=setTimeout(l.bind(this),200),Promise&&Promise.all(i).catch((function(e){})).then(l.bind(this))}.bind(this),function(t){"function"==typeof e&&e.call(this,t)}.bind(this)):"function"==typeof e&&e(new Error("The Web MIDI API is not supported by your browser.")))},n.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},n.prototype.addListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[e].push(t),this},n.prototype.hasListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(e)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[e].length;n++)if(this._userHandlers[e][n]===t)return!0;return!1},n.prototype.removeListener=function(e,t){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==t&&"function"!=typeof t)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(e))if(t)for(var n=0;n<this._userHandlers[e].length;n++)this._userHandlers[e][n]===t&&this._userHandlers[e].splice(n,1);else this._userHandlers[e]=[];else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},n.prototype.toMIDIChannels=function(e){var t;if("all"===e||void 0===e)t=["all"];else{if("none"===e)return[];t=Array.isArray(e)?e:[e]}return-1<t.indexOf("all")&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map((function(e){return parseInt(e)})).filter((function(e){return 1<=e&&e<=16}))},n.prototype.getInputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e)return this.inputs[t];return!1},n.prototype.getOutputById=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");e=String(e);for(var t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e)return this.outputs[t];return!1},n.prototype.getInputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1},n.prototype.getOctave=function(e){if(null!=e&&0<=e&&e<=127)return Math.floor(Math.floor(e)/12-1)+Math.floor(r.octaveOffset)},n.prototype.getOutputByName=function(e){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1},n.prototype.guessNoteNumber=function(e){var t=!1;if(e&&e.toFixed&&0<=e&&e<=127?t=Math.round(e):0<=parseInt(e)&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.noteNameToNumber(e)),!1===t)throw new Error("Invalid input value ("+e+").");return t},n.prototype.noteNameToNumber=function(e){"string"!=typeof e&&(e="");var t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)throw new RangeError("Invalid note name.");var n=r._semitones[t[1].toUpperCase()],i=12*(parseInt(t[3])+1-Math.floor(r.octaveOffset))+n;if(-1<t[2].toLowerCase().indexOf("b")?i-=t[2].length:-1<t[2].toLowerCase().indexOf("#")&&(i+=t[2].length),i<0||127<i)throw new RangeError("Invalid note name or note outside valid range.");return i},n.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},n.prototype._updateInputs=function(){for(var e=0;e<this._inputs.length;e++){for(var t=!0,n=this.interface.inputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._inputs[e]._midiInput===r.value){t=!1;break}t&&this._inputs.splice(e,1)}this.interface&&this.interface.inputs.forEach(function(e){for(var t=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===e&&(t=!1);t&&this._inputs.push(new i(e))}.bind(this))},n.prototype._updateOutputs=function(){for(var e=0;e<this._outputs.length;e++){for(var t=!0,n=this.interface.outputs.values(),r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&this._outputs.splice(e,1)}this.interface&&this.interface.outputs.forEach(function(e){for(var t=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===e&&(t=!1);t&&this._outputs.push(new o(e))}.bind(this))},n.prototype._onInterfaceStateChange=function(e){this._updateInputsAndOutputs();var t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?t.port=this.getOutputById(e.port.id):"input"===e.port.type&&(t.port=this.getInputById(e.port.id)):t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this._userHandlers[e.port.state].forEach((function(e){e(t)}))},n.prototype._resetInterfaceUserHandlers=function(){for(var e=0;e<this._midiInterfaceEvents.length;e++)this._userHandlers[this._midiInterfaceEvents[e]]=[]},i.prototype.on=i.prototype.addListener=function(e,t,n){var i=this;if(void 0===t&&(t="all"),Array.isArray(t)||(t=[t]),t.forEach((function(e){if("all"!==e&&!(1<=e&&e<=16))throw new RangeError("The 'channel' parameter is invalid.")})),"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==r.MIDI_SYSTEM_MESSAGES[e])this._userHandlers.system[e]||(this._userHandlers.system[e]=[]),this._userHandlers.system[e].push(n);else{if(void 0===r.MIDI_CHANNEL_MESSAGES[e])throw new TypeError("The specified event type is not supported.");if(-1<t.indexOf("all")){t=[];for(var o=1;o<=16;o++)t.push(o)}this._userHandlers.channel[e]||(this._userHandlers.channel[e]=[]),t.forEach((function(t){i._userHandlers.channel[e][t]||(i._userHandlers.channel[e][t]=[]),i._userHandlers.channel[e][t].push(n)}))}return this},i.prototype.hasListener=function(e,t,n){var i=this;if("function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==r.MIDI_SYSTEM_MESSAGES[e]){for(var o=0;o<this._userHandlers.system[e].length;o++)if(this._userHandlers.system[e][o]===n)return!0}else if(void 0!==r.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var s=1;s<=16;s++)t.push(s)}return!!this._userHandlers.channel[e]&&t.every((function(t){var r=i._userHandlers.channel[e][t];return r&&-1<r.indexOf(n)}))}return!1},i.prototype.removeListener=function(e,t,n){var i=this;if(void 0!==n&&"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===t&&(t="all"),t.constructor!==Array&&(t=[t]),void 0!==r.MIDI_SYSTEM_MESSAGES[e])if(void 0===n)this._userHandlers.system[e]=[];else for(var o=0;o<this._userHandlers.system[e].length;o++)this._userHandlers.system[e][o]===n&&this._userHandlers.system[e].splice(o,1);else if(void 0!==r.MIDI_CHANNEL_MESSAGES[e]){if(-1<t.indexOf("all")){t=[];for(var s=1;s<=16;s++)t.push(s)}if(!this._userHandlers.channel[e])return this;t.forEach((function(t){var r=i._userHandlers.channel[e][t];if(r)if(void 0===n)i._userHandlers.channel[e][t]=[];else for(var o=0;o<r.length;o++)r[o]===n&&r.splice(o,1)}))}else{if(void 0!==e)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},i.prototype._initializeUserHandlers=function(){for(var e in r.MIDI_CHANNEL_MESSAGES)r.MIDI_CHANNEL_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.channel[e]={});for(var t in r.MIDI_SYSTEM_MESSAGES)r.MIDI_SYSTEM_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.system[t]=[])},i.prototype._onMidiMessage=function(e){if(0<this._userHandlers.system.midimessage.length){var t={target:this,data:e.data,timestamp:e.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach((function(e){e(t)}))}e.data[0]<240?(this._parseChannelEvent(e),this._parseNrpnEvent(e)):e.data[0]<=255&&this._parseSystemEvent(e)},i.prototype._parseNrpnEvent=function(e){var t,n,i=e.data[0]>>4,o=15&e.data[0],s=1+o;if(1<e.data.length&&(t=e.data[1],n=2<e.data.length?e.data[2]:void 0),r.nrpnEventsEnabled&&i===r.MIDI_CHANNEL_MESSAGES.controlchange&&(t>=r.MIDI_NRPN_MESSAGES.increment&&t<=r.MIDI_NRPN_MESSAGES.parammsb||t===r.MIDI_NRPN_MESSAGES.entrymsb||t===r.MIDI_NRPN_MESSAGES.entrylsb)){var a={target:this,type:"controlchange",data:e.data,timestamp:e.timeStamp,channel:s,controller:{number:t,name:this.getCcNameByNumber(t)},value:n};if(a.controller.number===r.MIDI_NRPN_MESSAGES.parammsb&&a.value!=r.MIDI_NRPN_MESSAGES.nullactiveparameter)r._nrpnBuffer[o]=[],r._nrpnBuffer[o][0]=a;else if(1===r._nrpnBuffer[o].length&&a.controller.number===r.MIDI_NRPN_MESSAGES.paramlsb)r._nrpnBuffer[o].push(a);else if(2!==r._nrpnBuffer[o].length||a.controller.number!==r.MIDI_NRPN_MESSAGES.increment&&a.controller.number!==r.MIDI_NRPN_MESSAGES.decrement&&a.controller.number!==r.MIDI_NRPN_MESSAGES.entrymsb)if(3===r._nrpnBuffer[o].length&&r._nrpnBuffer[o][2].number===r.MIDI_NRPN_MESSAGES.entrymsb&&a.controller.number===r.MIDI_NRPN_MESSAGES.entrylsb)r._nrpnBuffer[o].push(a);else if(3<=r._nrpnBuffer[o].length&&r._nrpnBuffer[o].length<=4&&a.controller.number===r.MIDI_NRPN_MESSAGES.parammsb&&a.value===r.MIDI_NRPN_MESSAGES.nullactiveparameter)r._nrpnBuffer[o].push(a);else if(4<=r._nrpnBuffer[o].length&&r._nrpnBuffer[o].length<=5&&a.controller.number===r.MIDI_NRPN_MESSAGES.paramlsb&&a.value===r.MIDI_NRPN_MESSAGES.nullactiveparameter){r._nrpnBuffer[o].push(a);var u=[];r._nrpnBuffer[o].forEach((function(e){u.push(e.data)}));var l=r._nrpnBuffer[o][0].value<<7|r._nrpnBuffer[o][1].value,c=r._nrpnBuffer[o][2].value;6===r._nrpnBuffer[o].length&&(c=r._nrpnBuffer[o][2].value<<7|r._nrpnBuffer[o][3].value);var h="";switch(r._nrpnBuffer[o][2].controller.number){case r.MIDI_NRPN_MESSAGES.entrymsb:h=r._nrpnTypes[0];break;case r.MIDI_NRPN_MESSAGES.increment:h=r._nrpnTypes[1];break;case r.MIDI_NRPN_MESSAGES.decrement:h=r._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.")}var f={timestamp:a.timestamp,channel:a.channel,type:"nrpn",data:u,controller:{number:l,type:h,name:"Non-Registered Parameter "+l},value:c};r._nrpnBuffer[o]=[],this._userHandlers.channel[f.type]&&this._userHandlers.channel[f.type][f.channel]&&this._userHandlers.channel[f.type][f.channel].forEach((function(e){e(f)}))}else r._nrpnBuffer[o]=[];else r._nrpnBuffer[o].push(a)}},i.prototype._parseChannelEvent=function(e){var t,n,i=e.data[0]>>4,o=1+(15&e.data[0]);1<e.data.length&&(t=e.data[1],n=2<e.data.length?e.data[2]:void 0);var s={target:this,data:e.data,timestamp:e.timeStamp,channel:o};i===r.MIDI_CHANNEL_MESSAGES.noteoff||i===r.MIDI_CHANNEL_MESSAGES.noteon&&0===n?(s.type="noteoff",s.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},s.velocity=n/127,s.rawVelocity=n):i===r.MIDI_CHANNEL_MESSAGES.noteon?(s.type="noteon",s.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},s.velocity=n/127,s.rawVelocity=n):i===r.MIDI_CHANNEL_MESSAGES.keyaftertouch?(s.type="keyaftertouch",s.note={number:t,name:r._notes[t%12],octave:r.getOctave(t)},s.value=n/127):i===r.MIDI_CHANNEL_MESSAGES.controlchange&&0<=t&&t<=119?(s.type="controlchange",s.controller={number:t,name:this.getCcNameByNumber(t)},s.value=n):i===r.MIDI_CHANNEL_MESSAGES.channelmode&&120<=t&&t<=127?(s.type="channelmode",s.controller={number:t,name:this.getChannelModeByNumber(t)},s.value=n):i===r.MIDI_CHANNEL_MESSAGES.programchange?(s.type="programchange",s.value=t):i===r.MIDI_CHANNEL_MESSAGES.channelaftertouch?(s.type="channelaftertouch",s.value=t/127):i===r.MIDI_CHANNEL_MESSAGES.pitchbend?(s.type="pitchbend",s.value=((n<<7)+t-8192)/8192):s.type="unknownchannelmessage",this._userHandlers.channel[s.type]&&this._userHandlers.channel[s.type][o]&&this._userHandlers.channel[s.type][o].forEach((function(e){e(s)}))},i.prototype.getCcNameByNumber=function(e){if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var t in r.MIDI_CONTROL_CHANGE_MESSAGES)if(r.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===r.MIDI_CONTROL_CHANGE_MESSAGES[t])return t},i.prototype.getChannelModeByNumber=function(e){if(!(120<=(e=Math.floor(e))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var t in r.MIDI_CHANNEL_MODE_MESSAGES)if(r.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===r.MIDI_CHANNEL_MODE_MESSAGES[t])return t},i.prototype._parseSystemEvent=function(e){var t=e.data[0],n={target:this,data:e.data,timestamp:e.timeStamp};t===r.MIDI_SYSTEM_MESSAGES.sysex?n.type="sysex":t===r.MIDI_SYSTEM_MESSAGES.timecode?n.type="timecode":t===r.MIDI_SYSTEM_MESSAGES.songposition?n.type="songposition":t===r.MIDI_SYSTEM_MESSAGES.songselect?(n.type="songselect",n.song=e.data[1]):t===r.MIDI_SYSTEM_MESSAGES.tuningrequest?n.type="tuningrequest":t===r.MIDI_SYSTEM_MESSAGES.clock?n.type="clock":t===r.MIDI_SYSTEM_MESSAGES.start?n.type="start":t===r.MIDI_SYSTEM_MESSAGES.continue?n.type="continue":t===r.MIDI_SYSTEM_MESSAGES.stop?n.type="stop":t===r.MIDI_SYSTEM_MESSAGES.activesensing?n.type="activesensing":t===r.MIDI_SYSTEM_MESSAGES.reset?n.type="reset":n.type="unknownsystemmessage",this._userHandlers.system[n.type]&&this._userHandlers.system[n.type].forEach((function(e){e(n)}))},o.prototype.send=function(e,t,n){if(!(128<=e&&e<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===t&&(t=[]),Array.isArray(t)||(t=[t]);var r=[];return t.forEach((function(e){var t=Math.floor(e);if(!(0<=t&&t<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");r.push(t)})),this._midiOutput.send([e].concat(r),parseFloat(n)||0),this},o.prototype.sendSysex=function(e,t,n){if(!r.sysexEnabled)throw new Error("Sysex message support must first be activated.");return n=n||{},e=[].concat(e),t.forEach((function(e){if(e<0||127<e)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")})),t=e.concat(t,r.MIDI_SYSTEM_MESSAGES.sysexend),this.send(r.MIDI_SYSTEM_MESSAGES.sysex,t,this._parseTimeParameter(n.time)),this},o.prototype.sendTimecodeQuarterFrame=function(e,t){return t=t||{},this.send(r.MIDI_SYSTEM_MESSAGES.timecode,e,this._parseTimeParameter(t.time)),this},o.prototype.sendSongPosition=function(e,t){t=t||{};var n=(e=Math.floor(e)||0)>>7&127,i=127&e;return this.send(r.MIDI_SYSTEM_MESSAGES.songposition,[n,i],this._parseTimeParameter(t.time)),this},o.prototype.sendSongSelect=function(e,t){if(t=t||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(r.MIDI_SYSTEM_MESSAGES.songselect,[e],this._parseTimeParameter(t.time)),this},o.prototype.sendTuningRequest=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(e.time)),this},o.prototype.sendClock=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(e.time)),this},o.prototype.sendStart=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(e.time)),this},o.prototype.sendContinue=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(e.time)),this},o.prototype.sendStop=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(e.time)),this},o.prototype.sendActiveSensing=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(e.time)),this},o.prototype.sendReset=function(e){return e=e||{},this.send(r.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(e.time)),this},o.prototype.stopNote=function(e,t,n){if("all"===e)return this.sendChannelMode("allnotesoff",0,t,n);var i=64;return(n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(i=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(i=127*n.velocity),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(i)],this._parseTimeParameter(n.time))}.bind(this))}.bind(this)),this},o.prototype.playNote=function(e,t,n){var i,o=64;if((n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(o=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(o=127*n.velocity),i=this._parseTimeParameter(n.time),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteon<<4)+(t-1),[e,Math.round(o)],i)}.bind(this))}.bind(this)),!isNaN(n.duration)){n.duration<=0&&(n.duration=0);var s=64;n.rawVelocity?!isNaN(n.release)&&0<=n.release&&n.release<=127&&(s=n.release):!isNaN(n.release)&&0<=n.release&&n.release<=1&&(s=127*n.release),this._convertNoteToArray(e).forEach(function(e){r.toMIDIChannels(t).forEach(function(t){this.send((r.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(t-1),[e,Math.round(s)],(i||r.time)+n.duration)}.bind(this))}.bind(this))}return this},o.prototype.sendKeyAftertouch=function(e,t,n,i){var o=this;if(i=i||{},t<1||16<t)throw new RangeError("The channel must be between 1 and 16.");(isNaN(n)||n<0||1<n)&&(n=.5);var s=Math.round(127*n);return this._convertNoteToArray(e).forEach((function(e){r.toMIDIChannels(t).forEach((function(t){o.send((r.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(t-1),[e,s],o._parseTimeParameter(i.time))}))})),this},o.prototype.sendControlChange=function(e,t,n,i){if(i=i||{},"string"==typeof e){if(void 0===(e=r.MIDI_CONTROL_CHANGE_MESSAGES[e]))throw new TypeError("Invalid controller name.")}else if(!(0<=(e=Math.floor(e))&&e<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("Controller value must be between 0 and 127.");return r.toMIDIChannels(n).forEach(function(n){this.send((r.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(n-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},o.prototype._selectRegisteredParameter=function(e,t,n){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){i.sendControlChange(101,e[0],t,{time:n}),i.sendControlChange(100,e[1],t,{time:n})})),this},o.prototype._selectNonRegisteredParameter=function(e,t,n){var i=this;if(e[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(e[1]=Math.floor(e[1]),!(0<=e[1]&&e[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){i.sendControlChange(99,e[0],t,{time:n}),i.sendControlChange(98,e[1],t,{time:n})})),this},o.prototype._setCurrentRegisteredParameter=function(e,t,n){var i=this;if((e=[].concat(e))[0]=Math.floor(e[0]),!(0<=e[0]&&e[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){i.sendControlChange(6,e[0],t,{time:n})})),e[1]=Math.floor(e[1]),0<=e[1]&&e[1]<=127&&r.toMIDIChannels(t).forEach((function(){i.sendControlChange(38,e[1],t,{time:n})})),this},o.prototype._deselectRegisteredParameter=function(e,t){var n=this;return r.toMIDIChannels(e).forEach((function(){n.sendControlChange(101,127,e,{time:t}),n.sendControlChange(100,127,e,{time:t})})),this},o.prototype.setRegisteredParameter=function(e,t,n,i){var o=this;if(i=i||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(n).forEach((function(){o._selectRegisteredParameter(e,n,i.time),o._setCurrentRegisteredParameter(t,n,i.time),o._deselectRegisteredParameter(n,i.time)})),this},o.prototype.setNonRegisteredParameter=function(e,t,n,i){var o=this;if(i=i||{},!(0<=e[0]&&e[0]<=127&&0<=e[1]&&e[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return t=[].concat(t),r.toMIDIChannels(n).forEach((function(){o._selectNonRegisteredParameter(e,n,i.time),o._setCurrentRegisteredParameter(t,n,i.time),o._deselectRegisteredParameter(n,i.time)})),this},o.prototype.incrementRegisteredParameter=function(e,t,n){var i=this;if(n=n||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new Error("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(t).forEach((function(){i._selectRegisteredParameter(e,t,n.time),i.sendControlChange(96,0,t,{time:n.time}),i._deselectRegisteredParameter(t,n.time)})),this},o.prototype.decrementRegisteredParameter=function(e,t,n){if(n=n||{},!Array.isArray(e)){if(!r.MIDI_REGISTERED_PARAMETER[e])throw new TypeError("The specified parameter is not available.");e=r.MIDI_REGISTERED_PARAMETER[e]}return r.toMIDIChannels(t).forEach(function(){this._selectRegisteredParameter(e,t,n.time),this.sendControlChange(97,0,t,{time:n.time}),this._deselectRegisteredParameter(t,n.time)}.bind(this)),this},o.prototype.setPitchBendRange=function(e,t,n,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return r.toMIDIChannels(n).forEach((function(){o.setRegisteredParameter("pitchbendrange",[e,t],n,{time:i.time})})),this},o.prototype.setModulationRange=function(e,t,n,i){var o=this;if(i=i||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The cents value must be between 0 and 127");return r.toMIDIChannels(n).forEach((function(){o.setRegisteredParameter("modulationrange",[e,t],n,{time:i.time})})),this},o.prototype.setMasterTuning=function(e,t,n){var i=this;if(n=n||{},(e=parseFloat(e)||0)<=-65||64<=e)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var o=Math.floor(e)+64,s=e-Math.floor(e),a=(s=Math.round((s+1)/2*16383))>>7&127,u=127&s;return r.toMIDIChannels(t).forEach((function(){i.setRegisteredParameter("channelcoarsetuning",o,t,{time:n.time}),i.setRegisteredParameter("channelfinetuning",[a,u],t,{time:n.time})})),this},o.prototype.setTuningProgram=function(e,t,n){var i=this;if(n=n||{},!(0<=(e=Math.floor(e))&&e<=127))throw new RangeError("The program value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){i.setRegisteredParameter("tuningprogram",e,t,{time:n.time})})),this},o.prototype.setTuningBank=function(e,t,n){var i=this;if(n=n||{},!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The bank value must be between 0 and 127");return r.toMIDIChannels(t).forEach((function(){i.setRegisteredParameter("tuningbank",e,t,{time:n.time})})),this},o.prototype.sendChannelMode=function(e,t,n,i){if(i=i||{},"string"==typeof e){if(!(e=r.MIDI_CHANNEL_MODE_MESSAGES[e]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(e=Math.floor(e))&&e<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((t=Math.floor(t)||0)<0||127<t)throw new RangeError("Value must be an integer between 0 and 127.");return r.toMIDIChannels(n).forEach(function(n){this.send((r.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(n-1),[e,t],this._parseTimeParameter(i.time))}.bind(this)),this},o.prototype.sendProgramChange=function(e,t,n){var i=this;if(n=n||{},e=Math.floor(e),isNaN(e)||e<0||127<e)throw new RangeError("Program numbers must be between 0 and 127.");return r.toMIDIChannels(t).forEach((function(t){i.send((r.MIDI_CHANNEL_MESSAGES.programchange<<4)+(t-1),[e],i._parseTimeParameter(n.time))})),this},o.prototype.sendChannelAftertouch=function(e,t,n){var i=this;n=n||{},e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=.5);var o=Math.round(127*e);return r.toMIDIChannels(t).forEach((function(e){i.send((r.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(e-1),[o],i._parseTimeParameter(n.time))})),this},o.prototype.sendPitchBend=function(e,t,n){var i=this;if(n=n||{},isNaN(e)||e<-1||1<e)throw new RangeError("Pitch bend value must be between -1 and 1.");var o=Math.round((e+1)/2*16383),s=o>>7&127,a=127&o;return r.toMIDIChannels(t).forEach((function(e){i.send((r.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(e-1),[a,s],i._parseTimeParameter(n.time))})),this},o.prototype._parseTimeParameter=function(e){var t,n=parseFloat(e);return"string"==typeof e&&"+"===e.substring(0,1)?n&&0<n&&(t=r.time+n):n>r.time&&(t=n),t},o.prototype._convertNoteToArray=function(e){var t=[];return Array.isArray(e)||(e=[e]),e.forEach((function(e){t.push(r.guessNoteNumber(e))})),t},e.exports?e.exports=r:t.WebMidi||(t.WebMidi=r)}(te)}));const re="controlchange",ie="noteoff",oe="noteon",se="pitchbend";function ae(e,t){e.addListener(re,"all",t),e.addListener(ie,"all",t),e.addListener(oe,"all",t),e.addListener(se,"all",t)}const ue=[];function le(t,n=e){let r;const i=[];function o(e){if(a(t,e)&&(t=e,r)){const e=!ue.length;for(let e=0;e<i.length;e+=1){const n=i[e];n[1](),ue.push(n,t)}if(e){for(let e=0;e<ue.length;e+=2)ue[e][0](ue[e+1]);ue.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const u=[s,a];return i.push(u),1===i.length&&(r=n(o)||e),s(t),()=>{const e=i.indexOf(u);-1!==e&&i.splice(e,1),0===i.length&&(r(),r=null)}}}}function ce(e){return"[object Date]"===Object.prototype.toString.call(e)}function he(e,t={}){const n=le(e),{stiffness:r=.15,damping:i=.8,precision:o=.01}=t;let s,a,u,l=e,h=e,f=1,p=0,d=!1;function m(t,r={}){h=t;const i=u={};if(null==e||r.hard||g.stiffness>=1&&g.damping>=1)return d=!0,s=c(),l=t,n.set(e=h),Promise.resolve();if(r.soft){const e=!0===r.soft?.5:+r.soft;p=1/(60*e),f=0}return a||(s=c(),d=!1,a=_(t=>{if(d)return d=!1,a=null,!1;const r={inv_mass:f=Math.min(f+p,1),opts:g,settled:!0,dt:60*(t-s)/1e3},i=function e(t,n,r,i){if("number"==typeof r||ce(r)){const e=i-r,o=(r-n)/(t.dt||1/60),s=(o+(t.opts.stiffness*e-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(s)<t.opts.precision&&Math.abs(e)<t.opts.precision?i:(t.settled=!1,ce(r)?new Date(r.getTime()+s):r+s)}if(Array.isArray(r))return r.map((o,s)=>e(t,n[s],r[s],i[s]));if("object"==typeof r){const o={};for(const s in r)o[s]=e(t,n[s],r[s],i[s]);return o}throw new Error(`Cannot spring ${typeof r} values`)}(r,l,e,h);return s=t,l=e,n.set(e=i),r.settled&&(a=null),!r.settled})),new Promise(e=>{a.promise.then(()=>{i===u&&e()})})}const g={set:m,update:(t,n)=>m(t(h,e),n),subscribe:n.subscribe,stiffness:r,damping:i,precision:o};return g}function fe(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((t,n)=>fe(e[n],t));return e=>n.map(t=>t(e))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(ce(e)&&ce(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),r={};return n.forEach(n=>{r[n]=fe(e[n],t[n])}),e=>{const t={};return n.forEach(n=>{t[n]=r[n](e)}),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}function pe(e,r={}){const i=le(e);let o,s=e;function a(a,u){if(null==e)return i.set(e=a),Promise.resolve();s=a;let l=o,h=!1,{delay:f=0,duration:p=400,easing:d=t,interpolate:m=fe}=n(n({},r),u);const g=c()+f;let y;return(o=_(t=>{if(t<g)return!0;h||(y=m(e,a),"function"==typeof p&&(p=p(e,a)),h=!0),l&&(l.abort(),l=null);const n=t-g;return n>p?(i.set(e=a),!1):(i.set(e=y(d(n/p))),!0)})).promise}return{set:a,update:(t,n)=>a(t(s,e),n),subscribe:i.subscribe}}function de(t){let n,r,i,o;return{c(){n=M("g"),I(r=M("circle"),"r",i=Math.max(0,t.$sizeSpring)),I(n,"fill",t.color),I(n,"transform",o="translate("+[t.$springX,t.$springY]+")"),I(n,"data-id",t.id),I(n,"class","svelte-170p3sa")},m(e,t){y(e,n,t),g(n,r)},p(e,t){e.$sizeSpring&&i!==(i=Math.max(0,t.$sizeSpring))&&I(r,"r",i),e.color&&I(n,"fill",t.color),(e.$springX||e.$springY)&&o!==(o="translate("+[t.$springX,t.$springY]+")")&&I(n,"transform",o),e.id&&I(n,"data-id",t.id)},i:e,o:e,d(e){e&&E(n)}}}function me(e,t,n){let r,i,o,{id:s}=t,{x:a}=t,{y:l}=t,{size:c}=t,{color:h}=t,{deleted:f}=t,{low:p}=t,d=he(a,{stiffness:.06,damping:.5,precision:1});u(e,d,e=>n("$springX",r=e));let m=he(l,{stiffness:.1,damping:.25,precision:.1});u(e,m,e=>n("$springY",i=e));let _=he(c,{stiffness:.025,damping:1,precision:1});return u(e,_,e=>n("$sizeSpring",o=e)),e.$set=e=>{"id"in e&&n("id",s=e.id),"x"in e&&n("x",a=e.x),"y"in e&&n("y",l=e.y),"size"in e&&n("size",c=e.size),"color"in e&&n("color",h=e.color),"deleted"in e&&n("deleted",f=e.deleted),"low"in e&&n("low",p=e.low)},e.$$.update=(e={springX:1,x:1,springY:1,y:1,deleted:1,low:1,sizeSpring:1,size:1})=>{(e.springX||e.x)&&d.set(a),(e.springY||e.y||e.deleted||e.low)&&m.set(l+f?p:0),(e.sizeSpring||e.size)&&_.set(c),(e.deleted||e.sizeSpring)&&f&&_.set(0)},{id:s,x:a,y:l,size:c,color:h,deleted:f,low:p,springX:d,springY:m,sizeSpring:_,$springX:r,$springY:i,$sizeSpring:o}}class _e extends ee{constructor(e){super(),J(this,e,me,de,a,{id:0,x:0,y:0,size:0,color:0,deleted:0,low:0})}}const{Object:ge}=j;function ye(e,t,n){const r=ge.create(e);return r.item=t[n],r}function Ee(e,t){let r,i;const o=[t.item,{low:t.low}];let s={};for(let e=0;e<o.length;e+=1)s=n(s,o[e]);const a=new _e({props:s});return{key:e,first:null,c(){r=w(),X(a.$$.fragment),this.first=r},m(e,t){y(e,r,t),Q(a,e,t),i=!0},p(e,t){const n=e.items||e.low?U(o,[e.items&&V(t.item),e.low&&{low:t.low}]):{};a.$set(n)},i(e){i||(B(a.$$.fragment,e),i=!0)},o(e){Y(a.$$.fragment,e),i=!1},d(e){e&&E(r),Z(a,e)}}}function ve(e){let t,n,r=[],i=new Map,o=e.items;const s=e=>e.item.id;for(let t=0;t<o.length;t+=1){let n=ye(e,o,t),a=s(n);i.set(a,r[t]=Ee(a,n))}return{c(){t=M("svg");for(let e=0;e<r.length;e+=1)r[e].c();I(t,"width",e.width),I(t,"height",e.height)},m(e,i){y(e,t,i);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,o){const a=o.items;z(),r=W(r,e,s,1,o,a,i,t,q,Ee,null,ye),k(),n&&!e.width||I(t,"width",o.width),n&&!e.height||I(t,"height",o.height)},i(e){if(!n){for(let e=0;e<o.length;e+=1)B(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)Y(r[e]);n=!1},d(e){e&&E(t);for(let e=0;e<r.length;e+=1)r[e].d()}}}const Me=127,be=12;function Se(e,t,n){let r,i,o,s,a,u,l,c,{width:h}=t,{map:f}=t,{last:p}=t,{palette:d}=t,{min:m=24}=t,{max:_=48}=t,{margin:g=24}=t,{pad:y=16}=t,{low:E=168}=t;return e.$set=e=>{"width"in e&&n("width",h=e.width),"map"in e&&n("map",f=e.map),"last"in e&&n("last",p=e.last),"palette"in e&&n("palette",d=e.palette),"min"in e&&n("min",m=e.min),"max"in e&&n("max",_=e.max),"margin"in e&&n("margin",g=e.margin),"pad"in e&&n("pad",y=e.pad),"low"in e&&n("low",E=e.low)},e.$$.update=(e={max:1,min:1,pad:1,margin:1,y:1,low:1,last:1,map:1,values:1,distance:1,strip:1,width:1,multiply:1,delta:1,palette:1})=>{(e.max||e.min)&&n("delta",i=_-m),(e.max||e.pad)&&n("y",o=_+y),(e.max||e.margin)&&n("distance",s=2*_+g),e.y,(e.max||e.pad||e.low)&&n("height",a=_+2*y+E),(e.last||e.map)&&n("values",u=Object.values(f)),(e.values||e.distance||e.margin)&&n("strip",l=u.length*s+g),(e.strip||e.width||e.margin)&&n("multiply",c=l>h-2*g?(h-2*g)/l:1),(e.values||e.width||e.distance||e.multiply||e.y||e.min||e.delta||e.palette)&&n("items",r=u.sort((e,t)=>e.number-t.number).map(({event:e,number:t,value:n,deleted:r,id:a,order:u},l,{length:f})=>({id:u,x:h/2+(l-f/2+.5)*s*c,y:o,size:127*m/Me+i,color:d[t%be],deleted:r})))},{width:h,map:f,last:p,palette:d,min:m,max:_,margin:g,pad:y,low:E,items:r,height:a}}class we extends ee{constructor(e){super(),J(this,e,Se,ve,a,{width:0,map:0,last:0,palette:0,min:0,max:0,margin:0,pad:0,low:0})}}var Ie=Math.PI,xe=2*Ie,Ae=xe-1e-6;function Ne(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Te(){return new Ne}function De(e){return function(){return e}}Ne.prototype=Te.prototype={constructor:Ne,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-e,u=r-t,l=o-e,c=s-t,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6)if(Math.abs(c*a-u*l)>1e-6&&i){var f=n-o,p=r-s,d=a*a+u*u,m=f*f+p*p,_=Math.sqrt(d),g=Math.sqrt(h),y=i*Math.tan((Ie-Math.acos((d+h-m)/(2*_*g)))/2),E=y/g,v=y/_;Math.abs(E-1)>1e-6&&(this._+="L"+(e+E*l)+","+(t+E*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>l*p)+","+(this._x1=e+v*a)+","+(this._y1=t+v*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=e+s,l=t+a,c=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%xe+xe),h>Ae?this._+="A"+n+","+n+",0,1,"+c+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Ie)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Ce=Math.abs,$e=Math.atan2,Re=Math.cos,Pe=Math.max,Ge=Math.min,He=Math.sin,Oe=Math.sqrt,Le=1e-12,ze=Math.PI,ke=ze/2,Be=2*ze;function Ye(e){return e>=1?ke:e<=-1?-ke:Math.asin(e)}function je(e){return e.innerRadius}function Fe(e){return e.outerRadius}function qe(e){return e.startAngle}function We(e){return e.endAngle}function Ue(e){return e&&e.padAngle}function Ve(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/Oe(a*a+u*u),c=l*u,h=-l*a,f=e+c,p=t+h,d=n+c,m=r+h,_=(f+d)/2,g=(p+m)/2,y=d-f,E=m-p,v=y*y+E*E,M=i-o,b=f*m-d*p,S=(E<0?-1:1)*Oe(Pe(0,M*M*v-b*b)),w=(b*E-y*S)/v,I=(-b*y-E*S)/v,x=(b*E+y*S)/v,A=(-b*y+E*S)/v,N=w-_,T=I-g,D=x-_,C=A-g;return N*N+T*T>D*D+C*C&&(w=x,I=A),{cx:w,cy:I,x01:-c,y01:-h,x11:w*(i/M-1),y11:I*(i/M-1)}}function Xe(){var e=je,t=Fe,n=De(0),r=null,i=qe,o=We,s=Ue,a=null;function u(){var u,l,c,h=+e.apply(this,arguments),f=+t.apply(this,arguments),p=i.apply(this,arguments)-ke,d=o.apply(this,arguments)-ke,m=Ce(d-p),_=d>p;if(a||(a=u=Te()),f<h&&(l=f,f=h,h=l),f>Le)if(m>Be-Le)a.moveTo(f*Re(p),f*He(p)),a.arc(0,0,f,p,d,!_),h>Le&&(a.moveTo(h*Re(d),h*He(d)),a.arc(0,0,h,d,p,_));else{var g,y,E=p,v=d,M=p,b=d,S=m,w=m,I=s.apply(this,arguments)/2,x=I>Le&&(r?+r.apply(this,arguments):Oe(h*h+f*f)),A=Ge(Ce(f-h)/2,+n.apply(this,arguments)),N=A,T=A;if(x>Le){var D=Ye(x/h*He(I)),C=Ye(x/f*He(I));(S-=2*D)>Le?(M+=D*=_?1:-1,b-=D):(S=0,M=b=(p+d)/2),(w-=2*C)>Le?(E+=C*=_?1:-1,v-=C):(w=0,E=v=(p+d)/2)}var $=f*Re(E),R=f*He(E),P=h*Re(b),G=h*He(b);if(A>Le){var H,O=f*Re(v),L=f*He(v),z=h*Re(M),k=h*He(M);if(m<ze&&(H=function(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,h=a-o,f=h*u-c*l;if(!(f*f<Le))return[e+(f=(c*(t-o)-h*(e-i))/f)*u,t+f*l]}($,R,z,k,O,L,P,G))){var B=$-H[0],Y=R-H[1],j=O-H[0],F=L-H[1],q=1/He(((c=(B*j+Y*F)/(Oe(B*B+Y*Y)*Oe(j*j+F*F)))>1?0:c<-1?ze:Math.acos(c))/2),W=Oe(H[0]*H[0]+H[1]*H[1]);N=Ge(A,(h-W)/(q-1)),T=Ge(A,(f-W)/(q+1))}}w>Le?T>Le?(g=Ve(z,k,$,R,f,T,_),y=Ve(O,L,P,G,f,T,_),a.moveTo(g.cx+g.x01,g.cy+g.y01),T<A?a.arc(g.cx,g.cy,T,$e(g.y01,g.x01),$e(y.y01,y.x01),!_):(a.arc(g.cx,g.cy,T,$e(g.y01,g.x01),$e(g.y11,g.x11),!_),a.arc(0,0,f,$e(g.cy+g.y11,g.cx+g.x11),$e(y.cy+y.y11,y.cx+y.x11),!_),a.arc(y.cx,y.cy,T,$e(y.y11,y.x11),$e(y.y01,y.x01),!_))):(a.moveTo($,R),a.arc(0,0,f,E,v,!_)):a.moveTo($,R),h>Le&&S>Le?N>Le?(g=Ve(P,G,O,L,h,-N,_),y=Ve($,R,z,k,h,-N,_),a.lineTo(g.cx+g.x01,g.cy+g.y01),N<A?a.arc(g.cx,g.cy,N,$e(g.y01,g.x01),$e(y.y01,y.x01),!_):(a.arc(g.cx,g.cy,N,$e(g.y01,g.x01),$e(g.y11,g.x11),!_),a.arc(0,0,h,$e(g.cy+g.y11,g.cx+g.x11),$e(y.cy+y.y11,y.cx+y.x11),_),a.arc(y.cx,y.cy,N,$e(y.y11,y.x11),$e(y.y01,y.x01),!_))):a.arc(0,0,h,b,M,_):a.lineTo(P,G)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-ze/2;return[Re(r)*n,He(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:De(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:De(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:De(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:De(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:De(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:De(+e),u):o},u.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:De(+e),u):s},u.context=function(e){return arguments.length?(a=null==e?null:e,u):a},u}function Qe(e){return e<0?-1:1}function Ze(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(Qe(o)+Qe(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function Ke(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Je(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function et(e){this._context=e}function tt(e){this._context=e}function nt(t){let n,r,i,o;return{c(){n=M("g"),r=M("circle"),i=M("path"),I(r,"r",t.$dot_),I(i,"d",t.path),I(n,"fill",t.color),I(n,"transform",o="translate("+[t.$x_,t.$y_]+")"),I(n,"data-id",t.id),I(n,"class","svelte-170p3sa")},m(e,t){y(e,n,t),g(n,r),g(n,i)},p(e,t){e.$dot_&&I(r,"r",t.$dot_),e.path&&I(i,"d",t.path),e.color&&I(n,"fill",t.color),(e.$x_||e.$y_)&&o!==(o="translate("+[t.$x_,t.$y_]+")")&&I(n,"transform",o),e.id&&I(n,"data-id",t.id)},i:e,o:e,d(e){e&&E(n)}}}function rt(e,n,r){let i,o,s,a,l,c,{id:h}=n,{x:f}=n,{y:p}=n,{value:d}=n,{color:m}=n,{active:_}=n,{sizeInactive:g=[32,24,8]}=n,{size:y=[48,32,16]}=n;const E=he(f,{stiffness:.06,damping:.5,precision:1});u(e,E,e=>r("$x_",a=e));const v=he(p,{stiffness:.1,damping:.25,precision:.1});u(e,v,e=>r("$y_",l=e));const M=pe(d,{duration:0,easing:t});u(e,M,e=>r("$value_",s=e));const b=pe(y[0],{duration:200,easing:t});u(e,b,e=>r("$outer_",o=e));const S=pe(y[1],{duration:200,easing:t});u(e,S,e=>r("$inner_",i=e));const w=he(y[2],{stiffness:.1,damping:.5,precision:.1});u(e,w,e=>r("$dot_",c=e));const I=Xe();let x;return e.$set=e=>{"id"in e&&r("id",h=e.id),"x"in e&&r("x",f=e.x),"y"in e&&r("y",p=e.y),"value"in e&&r("value",d=e.value),"color"in e&&r("color",m=e.color),"active"in e&&r("active",_=e.active),"sizeInactive"in e&&r("sizeInactive",g=e.sizeInactive),"size"in e&&r("size",y=e.size)},e.$$.update=(e={x:1,y:1,value:1,active:1,size:1,sizeInactive:1,$inner_:1,$outer_:1,$value_:1})=>{e.x&&E.set(f),e.y&&v.set(p),e.value&&M.set(d),(e.active||e.size||e.sizeInactive)&&b.set(_?y[0]:g[0]),(e.active||e.size||e.sizeInactive)&&S.set(_?y[1]:g[1]),(e.active||e.size||e.sizeInactive)&&w.set(_?y[2]:g[2]),(e.$inner_||e.$outer_||e.$value_)&&r("path",x=I({innerRadius:i,outerRadius:o,startAngle:-Math.PI,endAngle:2*Math.PI*(s/127)-Math.PI}))},{id:h,x:f,y:p,value:d,color:m,active:_,sizeInactive:g,size:y,x_:E,y_:v,value_:M,outer_:b,inner_:S,dot_:w,path:x,$x_:a,$y_:l,$dot_:c}}et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Je(this,this._t0,Ke(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Je(this,Ke(this,n=Ze(this,e,t)),n);break;default:Je(this,this._t0,n=Ze(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(function(e){this._context=new tt(e)}.prototype=Object.create(et.prototype)).point=function(e,t){et.prototype.point.call(this,t,e)},tt.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};class it extends ee{constructor(e){super(),J(this,e,rt,nt,a,{id:0,x:0,y:0,value:0,color:0,active:0,sizeInactive:0,size:0})}}const{Object:ot}=j;function st(e,t,n){const r=ot.create(e);return r.item=t[n],r}function at(e,t){let r,i;const o=[t.item,{size:[48,32,16]},{sizeInactive:[32,24,8]}];let s={};for(let e=0;e<o.length;e+=1)s=n(s,o[e]);const a=new it({props:s});return{key:e,first:null,c(){r=w(),X(a.$$.fragment),this.first=r},m(e,t){y(e,r,t),Q(a,e,t),i=!0},p(e,t){const n=e.items?U(o,[V(t.item),o[1],o[2]]):{};a.$set(n)},i(e){i||(B(a.$$.fragment,e),i=!0)},o(e){Y(a.$$.fragment,e),i=!1},d(e){e&&E(r),Z(a,e)}}}function ut(e){let t,n,r,i=[],o=new Map,s=e.items;const a=e=>e.item.id;for(let t=0;t<s.length;t+=1){let n=st(e,s,t),r=a(n);o.set(r,i[t]=at(r,n))}return{c(){t=M("svg");for(let e=0;e<i.length;e+=1)i[e].c();I(t,"width",e.width),I(t,"height",n=2*(48+lt))},m(e,n){y(e,t,n);for(let e=0;e<i.length;e+=1)i[e].m(t,null);r=!0},p(e,n){const s=n.items;z(),i=W(i,e,a,1,n,s,o,t,q,at,null,st),k(),r&&!e.width||I(t,"width",n.width)},i(e){if(!r){for(let e=0;e<s.length;e+=1)B(i[e]);r=!0}},o(e){for(let e=0;e<i.length;e+=1)Y(i[e]);r=!1},d(e){e&&E(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}let lt=32;function ct(e,t,n){let r,{map:i}=t,{width:o}=t,{palette:s}=t,{last:a}=t;return e.$set=e=>{"map"in e&&n("map",i=e.map),"width"in e&&n("width",o=e.width),"palette"in e&&n("palette",s=e.palette),"last"in e&&n("last",a=e.last)},e.$$.update=(e={last:1,map:1,width:1,margin:1,palette:1})=>{(e.last||e.map||e.width||e.margin||e.palette)&&n("items",r=Object.values(i).sort((e,t)=>e.number-t.number).map(({event:e,number:t,value:n,deleted:r,id:i,order:a,active:u},l,{length:c})=>({id:i,x:o/2+128*(l-c/2)+48+16,y:48+lt,value:n,color:-1===t?"#fff":s[t%s.length],active:u})))},{map:i,width:o,palette:s,last:a,items:r}}class ht extends ee{constructor(e){super(),J(this,e,ct,ut,a,{map:0,width:0,palette:0,last:0})}}const ft=["#ab47bc","#7e57c2","#5c6bc0","#42a5f5","#26a69a","#4caf50","#8bc34a","#b0e002","#ffeb3b","#ffc107","#f5753c","#e91e63"],pt=["#ffeb3b","#ffc107","#f5753c","#e91e63","#ab47bc","#7e57c2","#5c6bc0","#42a5f5"];function dt(e,t,n){const r=Object.create(e);return r.cell=t[n],r.index=n,r}function mt(e,t,n){const r=Object.create(e);return r.item=t[n],r.index=n,r}function _t(e,t,n){const r=Object.create(e);return r.m=t[n],r.index=n,r}function gt(e){let t,n,r,i=[],o=new Map,s=[],a=new Map,u=e.messages.slice(Math.max(0,e.messages.length-16));const l=e=>e.index;for(let t=0;t<u.length;t+=1){let n=_t(e,u,t),r=l(n);o.set(r,i[t]=yt(r,n))}let c=e.logs.slice(Math.max(0,e.logs.length-16));const h=e=>e.index;for(let t=0;t<c.length;t+=1){let n=mt(e,c,t),r=h(n);a.set(r,s[t]=vt(r,n))}return{c(){t=v("div");for(let e=0;e<i.length;e+=1)i[e].c();n=S(),r=v("div");for(let e=0;e<s.length;e+=1)s[e].c();I(t,"class","x-messages svelte-1aueya0"),I(r,"class","x-logs svelte-1aueya0")},m(e,o){y(e,t,o);for(let e=0;e<i.length;e+=1)i[e].m(t,null);y(e,n,o),y(e,r,o);for(let e=0;e<s.length;e+=1)s[e].m(r,null)},p(e,n){const u=n.messages.slice(Math.max(0,n.messages.length-16));i=W(i,e,l,1,n,u,o,t,F,yt,null,_t);const c=n.logs.slice(Math.max(0,n.logs.length-16));s=W(s,e,h,1,n,c,a,r,F,vt,null,mt)},d(e){e&&E(t);for(let e=0;e<i.length;e+=1)i[e].d();e&&E(n),e&&E(r);for(let e=0;e<s.length;e+=1)s[e].d()}}}function yt(e,t){let n,r,i,o,s,a,u,l,c,h,f=t.m.event.target.id+"",p=t.m.event.channel+"",d=St(t.m.event)+"";return{key:e,first:null,c(){n=v("div"),r=v("div"),i=b(f),o=S(),s=v("div"),a=b(p),u=S(),l=v("div"),c=b(d),h=S(),I(r,"class","svelte-1aueya0"),I(s,"class","svelte-1aueya0"),I(l,"class","svelte-1aueya0"),I(n,"class","svelte-1aueya0"),this.first=n},m(e,t){y(e,n,t),g(n,r),g(r,i),g(n,o),g(n,s),g(s,a),g(n,u),g(n,l),g(l,c),g(n,h)},p(e,t){e.messages&&f!==(f=t.m.event.target.id+"")&&x(i,f),e.messages&&p!==(p=t.m.event.channel+"")&&x(a,p),e.messages&&d!==(d=St(t.m.event)+"")&&x(c,d)},d(e){e&&E(n)}}}function Et(e,t){let n,r,i=t.cell+"";return{key:e,first:null,c(){n=v("div"),r=b(i),I(n,"class","svelte-1aueya0"),this.first=n},m(e,t){y(e,n,t),g(n,r)},p(e,t){e.logs&&i!==(i=t.cell+"")&&x(r,i)},d(e){e&&E(n)}}}function vt(e,t){let n,r,i=[],o=new Map,s=t.item;const a=e=>e.index;for(let e=0;e<s.length;e+=1){let n=dt(t,s,e),r=a(n);o.set(r,i[e]=Et(r,n))}return{key:e,first:null,c(){n=v("div");for(let e=0;e<i.length;e+=1)i[e].c();r=S(),I(n,"class","svelte-1aueya0"),this.first=n},m(e,t){y(e,n,t);for(let e=0;e<i.length;e+=1)i[e].m(n,null);g(n,r)},p(e,t){const s=t.item;i=W(i,e,a,1,t,s,o,n,F,Et,r,dt)},d(e){e&&E(n);for(let e=0;e<i.length;e+=1)i[e].d()}}}function Mt(e){let t,n,r,i,o,s,a,u;P(e.onwindowresize),document.body.addEventListener("mousemove",e.mouseMoveHandler);const l=new we({props:{width:e.width,last:e.last,map:e.notesMap,palette:ft}}),c=new ht({props:{map:e.controlsMap,width:e.width,palette:pt,last:e.last}});let h=e.showMeta&&gt(e);return{c(){var a,f,p,d;t=S(),n=v("div"),X(l.$$.fragment),r=S(),i=v("div"),X(c.$$.fragment),o=S(),h&&h.c(),s=w(),I(n,"class","notes svelte-1aueya0"),I(i,"class","controls svelte-1aueya0"),a=window,f="resize",p=e.onwindowresize,a.addEventListener(f,p,d),u=()=>a.removeEventListener(f,p,d)},m(e,u){y(e,t,u),y(e,n,u),Q(l,n,null),y(e,r,u),y(e,i,u),Q(c,i,null),y(e,o,u),h&&h.m(e,u),y(e,s,u),a=!0},p(e,t){const n={};e.width&&(n.width=t.width),e.last&&(n.last=t.last),e.notesMap&&(n.map=t.notesMap),l.$set(n);const r={};e.controlsMap&&(r.map=t.controlsMap),e.width&&(r.width=t.width),e.last&&(r.last=t.last),c.$set(r),t.showMeta?h?h.p(e,t):((h=gt(t)).c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},i(e){a||(B(l.$$.fragment,e),B(c.$$.fragment,e),a=!0)},o(e){Y(l.$$.fragment,e),Y(c.$$.fragment,e),a=!1},d(a){document.body.removeEventListener("mousemove",e.mouseMoveHandler),a&&E(t),a&&E(n),Z(l),a&&E(r),a&&E(i),Z(c),a&&E(o),h&&h.d(a),a&&E(s),u()}}}function bt(e){return`${e<16?"0":""}${e.toString(16)}`}function St({data:e}){return Array.from(e).map(bt).join(" ")}function wt(e,t,n){let r,i=0,o=0,s=[];const a={},u={};let l=[];!function(e,t){ne.enable((function(n){n&&console.error("WebMidi could not be enabled.",n),ne.inputs.forEach(n=>{const{id:r,name:i}=n;t([r,i,"on"]),ae(n,e)}),ne.interface.addEventListener("statechange",n=>{const{id:r,type:i,state:o,name:s}=n.port;"input"===i&&(t([r,s,o]),ne.inputs.forEach(n=>{n.hasListener(ie,"all",e)||(t([r,s,"on"]),ae(n,e))}))})}))}((async function(e){await new Promise(e=>requestAnimationFrame(e));const t=function(e){return`${e.target.id}-${e.channel}-${e.controller?`controller-${e.controller.number}`:e.note?`note-${e.note.number}`:""}`}(e);n("messages",s=[...s,{event:e,id:t}]);const r=e.controller?e.controller.number:e.note?e.note.number:-1,l=e.type===se?127*(e.value+1)/2:void 0!==e.value?e.value:void 0!==e.rawVelocity?e.rawVelocity:64;if(e.type===ie)return a[t]&&n("notesMap",a[t].deleted=!0,a),void setTimeout(()=>{a[t]&&a[t].deleted&&(delete a[t],n("last",++i))},1200);if(++o,e.type===oe)return void n("notesMap",a[t]={event:e,number:r,value:l,deleted:!1,order:o,id:t},a);n("controlsMap",u[t]={event:e,number:r,value:l,deleted:!1,order:o,id:t,active:!0},u),setTimeout(()=>{u[t].event===e&&(n("controlsMap",u[t].active=!1,u),n("last",++i))},1200),setTimeout(()=>{u[t].event===e&&(delete u[t],n("last",++i))},9600)}),(function(e){n("logs",l=[...l,e])}));let c=!0,h=null;function f(){n("showMeta",c=!0),h&&clearTimeout(h),h=setTimeout(()=>{n("showMeta",c=!1),h=null},8e3)}return f(),{width:r,last:i,messages:s,notesMap:a,controlsMap:u,logs:l,showMeta:c,mouseMoveHandler:f,onwindowresize:function(){n("width",r=window.innerWidth)}}}return new class extends ee{constructor(e){super(),J(this,e,wt,Mt,a,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
